# BattleSoul RPG - Telegram Bot –∑ SDK —Ç–∞ React UI

## –û–≥–ª—è–¥ –ø—Ä–æ—î–∫—Ç—É

BattleSoul RPG ‚Äî —Ü–µ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π Telegram RPG-–±–æ—Ç –∑ —Å–∏—Å—Ç–µ–º–æ—é SDK —Ç–∞ React –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—î—é –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–æ—Ç–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### Backend (Node.js + TypeScript)
- **Telegram Bot** (`server/bot.ts`): –û–±—Ä–æ–±–ª—è—î –∑–≤–∏—á–∞–π–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑ —Å–ª–µ—à—ñ–≤, –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥ —á–µ—Ä–µ–∑ @username —Ç–∞ reply
- **SDK** (`server/sdk.ts`): –°–∏—Å—Ç–µ–º–∞ –∑ —Ö—É–∫–æ–º `useCommand` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ–º–∞–Ω–¥
- **WebSocket** (`server/routes.ts`): Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –º—ñ–∂ –±–æ—Ç–æ–º —Ç–∞ React UI
- **PostgreSQL**: –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –ø–∏—Ç–æ–º—Ü—ñ–≤ —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó –±–æ—ó–≤
- **JSON –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è** (`commands.json`): –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### Frontend (React + TypeScript)
- **React Dashboard**: –¢—Ä–∏ –≤–∫–ª–∞–¥–∫–∏ - –ü—Ä–æ—Ñ—ñ–ª—å, –ú–∞–≥–∞–∑–∏–Ω, –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **WebSocket –∫–ª—ñ—î–Ω—Ç**: –û—Ç—Ä–∏–º—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥ –±–æ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- **Shadcn UI**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

### –¢–∞–±–ª–∏—Ü—è `users`
- `id`: UUID
- `telegram_id`: ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ Telegram
- `username`: –Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `hp`, `max_hp`: –ó–¥–æ—Ä–æ–≤'—è
- `xp`, `lvl`: –î–æ—Å–≤—ñ–¥ —Ç–∞ —Ä—ñ–≤–µ–Ω—å
- `wins`, `total_battles`, `total_damage`: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—ó–≤
- `status`: –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å –≥—Ä–∞–≤—Ü—è
- `last_action`: –ß–∞—Å –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –¥—ñ—ó

### –¢–∞–±–ª–∏—Ü—è `pets`
- `id`: UUID
- `user_id`: ID –≤–ª–∞—Å–Ω–∏–∫–∞
- `name`, `emoji`: –ù–∞–∑–≤–∞ —Ç–∞ —ñ–∫–æ–Ω–∫–∞ –ø–∏—Ç–æ–º—Ü—è
- `level`, `hp`, `max_hp`, `strength`: –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- `evolution_stage`, `max_evolution_stage`: –ï–≤–æ–ª—é—Ü—ñ—è
- `owned`: –ß–∏ –Ω–∞–ª–µ–∂–∏—Ç—å –≥—Ä–∞–≤—Ü—é

### –¢–∞–±–ª–∏—Ü—è `battles`
- `id`: UUID
- `attacker_id`, `target_id`: –£—á–∞—Å–Ω–∏–∫–∏ –±–æ—é
- `command`, `emoji`: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞
- `value`: –í–µ–ª–∏—á–∏–Ω–∞ —à–∫–æ–¥–∏/–∑—Ü—ñ–ª–µ–Ω–Ω—è
- `type`: –¢–∏–ø –∫–æ–º–∞–Ω–¥–∏ (damage, heal, curse)
- `created_at`: –ß–∞—Å –±–æ—é

## SDK - useCommand Hook

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è SDK –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ–º–∞–Ω–¥:

```typescript
import { useCommand } from "./server/sdk";

useCommand('–∞—Ç–∞–∫–∞', (ctx) => {
  console.log(`‚öîÔ∏è ${ctx.sender} –∞—Ç–∞–∫—É—î ${ctx.target} ‚Äî ${ctx.damage} —à–∫–æ–¥–∏!`);
});

useCommand('–∑—Ü—ñ–ª–µ–Ω–Ω—è', (ctx) => {
  console.log(`üíö ${ctx.sender} –∑—Ü—ñ–ª–∏–≤ ${ctx.target} –Ω–∞ ${ctx.damage} HP!`);
});
```

## –ö–æ–º–∞–Ω–¥–∏ –±–æ—Ç–∞

–ö–æ–º–∞–Ω–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ `commands.json` —Ç–∞ –º–æ–∂–Ω–∞ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ API:

- **–∞—Ç–∞–∫–∞** ‚öîÔ∏è - –ó–∞–≤–¥–∞—î 5-20 —à–∫–æ–¥–∏
- **–∑—Ü—ñ–ª–µ–Ω–Ω—è** üíö - –í—ñ–¥–Ω–æ–≤–ª—é—î 10-20 HP
- **–ø—Ä–æ–∫–ª—è—Ç—Ç—è** ‚ò†Ô∏è - –ó–º–µ–Ω—à—É—î —Å–∏–ª—É –Ω–∞ 3-15
- **–∑–∞—Ö–∏—Å—Ç** üõ°Ô∏è - –ü—ñ–¥–≤–∏—â—É—î –∑–∞—Ö–∏—Å—Ç

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±–æ—Ç–∞

1. –ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ —á–∞—Ç—ñ: "–∞—Ç–∞–∫–∞ @username"
2. –ê–±–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–π—Ç–µ –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "–∑—Ü—ñ–ª–µ–Ω–Ω—è" (reply –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞)
3. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç—å —Ü—ñ–ª—å —Ç–∞ –≤–∏–∫–æ–Ω–∞—î –∫–æ–º–∞–Ω–¥—É

–ü—Ä–∏–∫–ª–∞–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:
```
‚öîÔ∏è @dimon –∞—Ç–∞–∫—É—î @alex ‚Äî 15 —à–∫–æ–¥–∏! üí•
üíö @dimon –∑—Ü—ñ–ª–∏–≤ @alex –Ω–∞ 12 HP! üåø
‚ò†Ô∏è @dimon –ø—Ä–æ–∫–ª—è–≤ @alex ‚Äî —Å–∏–ª–∞ –∑–º–µ–Ω—à–∏–ª–∞—Å—å –Ω–∞ 8%! üåÄ
```

## Environment Variables

- `BOT_TOKEN` - Telegram Bot Token –≤—ñ–¥ @BotFather
- `DATABASE_URL` - PostgreSQL connection string (–≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ)

## WebSocket Events

- **Connection**: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞
- **update**: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (users, battles) –∫–æ–∂–Ω—ñ 2 —Å–µ–∫—É–Ω–¥–∏

## API Endpoints

- `GET /api/users` - –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- `GET /api/users/:id` - –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ ID
- `GET /api/battles` - –û—Ç—Ä–∏–º–∞—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –±–æ—ó–≤
- `GET /api/commands` - –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `POST /api/commands` - –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –∫–æ–º–∞–Ω–¥—É

## React UI

### –í–∫–ª–∞–¥–∫–∞ "–ü—Ä–æ—Ñ—ñ–ª—å"
- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (HP, XP, Level)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—ó–≤ (–ø–µ—Ä–µ–º–æ–≥–∏, –∑–∞–≥–∞–ª—å–Ω–∞ —à–∫–æ–¥–∞)
- –î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –∑ –æ–ø–∏—Å–æ–º

### –í–∫–ª–∞–¥–∫–∞ "–ú–∞–≥–∞–∑–∏–Ω"
- –ö–∞—Ä—Ç–∫–∏ –ø–∏—Ç–æ–º—Ü—ñ–≤ –∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- –°–∏—Å—Ç–µ–º–∞ –µ–≤–æ–ª—é—Ü—ñ—ó (5 —Å—Ç–∞–¥—ñ–π)
- –ö—É–ø—ñ–≤–ª—è –ø–∏—Ç–æ–º—Ü—ñ–≤ –∑–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—É –≤–∞–ª—é—Ç—É

### –í–∫–ª–∞–¥–∫–∞ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
- –†–µ–π—Ç–∏–Ω–≥ –≥—Ä–∞–≤—Ü—ñ–≤ (win rate, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–æ—ó–≤)
- –Ü—Å—Ç–æ—Ä—ñ—è –±–æ—ó–≤ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä—É

## –Ø–∫ —Ä–æ–∑–ø–æ—á–∞—Ç–∏

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ BOT_TOKEN –≤—ñ–¥ @BotFather –≤ Telegram
2. –î–æ–¥–∞–π—Ç–µ BOT_TOKEN –¥–æ —Å–µ–∫—Ä–µ—Ç—ñ–≤ –ø—Ä–æ—î–∫—Ç—É
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å `npm run dev`
4. –í—ñ–¥–∫—Ä–∏–π—Ç–µ React UI —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–æ—Ç–∞

## Recent Changes
- 2025-01-01: –°—Ç–≤–æ—Ä–µ–Ω–æ –±–∞–∑–æ–≤—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ—î–∫—Ç—É
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ Telegram –±–æ—Ç–∞ –∑ –æ–±—Ä–æ–±–∫–æ—é –∫–æ–º–∞–Ω–¥
- –î–æ–¥–∞–Ω–æ SDK –∑ —Ö—É–∫–æ–º useCommand
- –°—Ç–≤–æ—Ä–µ–Ω–æ React UI –∑ WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º
- –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ PostgreSQL –±–∞–∑—É –¥–∞–Ω–∏—Ö

## User Preferences
- –ú–æ–≤–∞: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
- –°—Ç–∏–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π: RPG –∑ –µ–º–æ–¥–∑—ñ (‚öîÔ∏è, üíö, ‚ò†Ô∏è, üí•)
